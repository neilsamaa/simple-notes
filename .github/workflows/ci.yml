name: Docker Build, Push, and Deploy

on:
  push:
    branches: [ "main" ]

env:
  DOCKER_IMAGE_TAG: simple-notes-1.0
  DOCKER_IMAGE_NAME: neilsamaa/applications
  CONTAINER_NAME: simple-notes

jobs:
  build-push-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Login to Docker Hub
      run: docker login -u ${{ secrets.DOCKER_USERNAME }} -p ${{ secrets.DOCKER_TOKEN }}

    - name: Build Docker Image
      run: docker build -t $DOCKER_IMAGE_NAME:$DOCKER_IMAGE_TAG .

    - name: Push Docker Image
      run: docker push $DOCKER_IMAGE_NAME:$DOCKER_IMAGE_TAG
    
    - name: Logout from Docker Hub
      run: docker logout
